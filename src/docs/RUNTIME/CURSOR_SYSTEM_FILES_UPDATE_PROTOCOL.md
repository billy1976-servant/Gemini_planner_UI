# ***SYSTEM_FILES_UPDATE_PROTOCOL***

***Purpose: Fast architecture drift detection and contract sync (diff-first, not full regeneration).***

## ***When to Run***

- ***After major refactors, new subsystems, or layout/behavior/state changes***
- ***When autogenerated docs feel out of date or unclear***
- ***Before large planning or execution work***

---

## ***Steps (execute in order)***

### ***1. Scan the repository source code (lightweight structural pass)***

- ***Scan all source under src/ (and any other folders that contain runtime/engine code)***
- ***Include: engine, layout, state, organs, compounds, UI, registries, loaders, and entry points***
- ***Build a structural mental model only (do NOT write files yet)***

***Focus on identifying changes to:***

- ***Entry points***
- ***Runtime pipeline stages***
- ***Layout resolution flow***
- ***Behavior ‚Üí state wiring***
- ***Registry definitions***
- ***Data flow into renderer***

---

### ***2. Re-derive current contracts in memory only***

***Reconstruct the current architecture from code:***

- ***Runtime pipeline: Request ‚Üí resolution ‚Üí render path ‚Üí fallbacks***
- ***Layout resolution order and compatibility filtering***
- ***Behavior/state wiring (who reads/writes what)***
- ***Registry map (types ‚Üí components ‚Üí files)***
- ***Data flow (screen/JSON/content ‚Üí renderer)***

***‚ö†Ô∏è Do NOT regenerate any docs yet.***

---

### ***3. Compare against existing autogenerated docs (diff-first)***

***Read all files in:***

- ***src/docs/ARCHITECTURE_AUTOGEN/*** (including ***SYSTEM_INTELLIGENCE/*** subfolder)
- ***src/docs/SYSTEM_MAP_AUTOGEN/***
- ***src/docs/SYSTEM_INTELLIGENCE_AUTOGEN/*** (including ***graphs/*** subfolder)

***For each doc:***

- ***Compare its described contracts to the current code-derived picture***
- ***Identify only meaningful architectural differences***

***Do not rewrite unchanged sections.***

---

### ***4. Produce a DIFF REPORT (no regeneration)***

***Save the report to:***
- ***Folder:*** `src/docs/System Files Update Reports/`
- ***Filename:*** `DIFF_YYYY-MM-DD_HH-MM-SS.md` (e.g. `DIFF_2025-02-04_14-30-00.md`). The timestamp in the filename ensures multiple runs on the same day do not overwrite each other.

***Include in the report header:***
- ***Run date/time:*** `YYYY-MM-DD HH:MM` (or `HH:MM:SS`) so each run is uniquely identified.

***Create one report listing:***

### ***üî¥ Outdated docs***

***Docs that no longer match runtime behavior***  
 ***‚Üí Include 1‚Äì3 bullet points describing the mismatch***

### ***üü° Missing docs***

***Architectural contracts found in code that have no doc***

### ***üü¢ New contracts discovered***

***New patterns or systems not yet reflected in autogen docs***

---

### ***5. Propose updates (do not apply)***

***For each affected doc:***

- ***Provide only the changed sections***
- ***Label clearly:***  
 ***‚ÄúProposed update for: [filename.md](http://filename.md)‚Äù***

***‚ö†Ô∏è Do NOT regenerate entire files***  
 ***‚ö†Ô∏è Do NOT overwrite anything***

---

### ***6. User confirmation required***

***After presenting the DIFF REPORT:***

- ***Wait for user approval before modifying any files***
- ***Apply only approved updates***
- ***Leave all other files untouched***

## ***Output***

- ***One DIFF REPORT*** saved to `src/docs/System Files Update Reports/DIFF_YYYY-MM-DD_HH-MM-SS.md` (outdated / missing / new contracts; run date and time in header; timestamp in filename so same-day runs are not replaced)
- ***Proposed updates for only the affected autogenerated docs***
- ***No file changes until user confirms***

